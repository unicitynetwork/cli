# =============================================================================
# CI/CD Environment Configuration for Unicity CLI Test Suite
# =============================================================================
# This file contains environment variables and configuration for CI/CD
# pipeline testing. Load with: source tests/config/ci.env
#
# Usage:
#   export $(cat tests/config/ci.env | xargs)
#   source tests/config/ci.env
# =============================================================================

# =============================================================================
# Test Execution Configuration
# =============================================================================

# Enable debug output in tests
UNICITY_TEST_DEBUG=0

# Enable verbose assertion output
UNICITY_TEST_VERBOSE=0

# Keep temporary test files for inspection
UNICITY_TEST_KEEP_TMP=0

# Skip external service dependencies (aggregator, etc.)
UNICITY_TEST_SKIP_EXTERNAL=0

# Wait for aggregator to be ready before running tests
UNICITY_TEST_WAIT_FOR_AGGREGATOR=1

# Test timeout in seconds
UNICITY_TEST_TIMEOUT=300

# =============================================================================
# Aggregator Configuration
# =============================================================================

# Aggregator endpoint URL
AGGREGATOR_ENDPOINT=http://localhost:3000

# Aggregator hostname (for Docker)
AGGREGATOR_HOST=localhost

# Aggregator port
AGGREGATOR_PORT=3000

# Aggregator health check path
AGGREGATOR_HEALTH_PATH=/health

# Aggregator health check timeout
AGGREGATOR_HEALTH_TIMEOUT=30

# Maximum retries for aggregator health check
AGGREGATOR_HEALTH_RETRIES=10

# =============================================================================
# Test Directory Configuration
# =============================================================================

# Base test directory
TEST_BASE_DIR=tests

# Results output directory
TEST_RESULTS_DIR=tests/results

# Reports output directory
TEST_REPORTS_DIR=tests/reports

# Temporary files directory
BATS_TMPDIR=/tmp/bats-tmp

# =============================================================================
# Test Suite Selection
# =============================================================================

# Run functional tests
RUN_FUNCTIONAL_TESTS=1

# Run security tests
RUN_SECURITY_TESTS=1

# Run edge case tests
RUN_EDGE_CASE_TESTS=1

# Run unit tests
RUN_UNIT_TESTS=1

# =============================================================================
# Test Execution Options
# =============================================================================

# Run tests in parallel
PARALLEL_TESTS=0

# Number of parallel jobs
PARALLEL_JOBS=4

# Fail immediately on first failure
FAIL_FAST=0

# Generate JSON reports
GENERATE_JSON_REPORT=1

# Generate HTML reports
GENERATE_HTML_REPORT=1

# Generate text coverage reports
GENERATE_COVERAGE_REPORT=1

# =============================================================================
# CI/CD Platform Configuration
# =============================================================================

# CI provider (github, gitlab, jenkins, local)
CI_PROVIDER=github

# CI mode enabled
CI=true

# CI build ID (set by CI system)
CI_BUILD_ID=${CI_BUILD_ID:-local-$(date +%s)}

# CI commit hash
CI_COMMIT_SHA=${CI_COMMIT_SHA:-}

# CI branch name
CI_BRANCH=${CI_BRANCH:-main}

# CI pull request number
CI_PR_NUMBER=${CI_PR_NUMBER:-}

# CI job name
CI_JOB_NAME=${CI_JOB_NAME:-test}

# =============================================================================
# Node.js and NPM Configuration
# =============================================================================

# Node environment
NODE_ENV=test

# NPM log level
NPM_LOG_LEVEL=warn

# Enable npm audit
NPM_AUDIT=1

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Enable colored output
USE_COLORS=1

# Log to file
LOG_FILE=${TEST_RESULTS_DIR}/test.log

# Log file rotation
LOG_ROTATION=1

# =============================================================================
# Security Configuration
# =============================================================================

# Require secure connections only
SECURE_ONLY=0

# Verify SSL certificates
SSL_VERIFY=1

# API authentication token
API_TOKEN=${API_TOKEN:-}

# =============================================================================
# Performance Configuration
# =============================================================================

# Connection timeout in seconds
CONNECTION_TIMEOUT=30

# Request timeout in seconds
REQUEST_TIMEOUT=60

# Test suite timeout in seconds
SUITE_TIMEOUT=300

# Individual test timeout in seconds
TEST_TIMEOUT=30

# =============================================================================
# Artifact Configuration
# =============================================================================

# Archive test results
ARCHIVE_RESULTS=1

# Retention period for artifacts (days)
ARTIFACT_RETENTION_DAYS=30

# Upload artifacts to storage
UPLOAD_ARTIFACTS=1

# Artifact storage path
ARTIFACT_STORAGE_PATH=s3://unicity-test-results

# =============================================================================
# Notification Configuration
# =============================================================================

# Send email notifications on failure
EMAIL_ON_FAILURE=0

# Email address for notifications
EMAIL_ADDRESS=

# Slack notifications enabled
SLACK_NOTIFICATIONS=0

# Slack webhook URL
SLACK_WEBHOOK_URL=

# =============================================================================
# Database Configuration (if needed)
# =============================================================================

# Database host
DB_HOST=localhost

# Database port
DB_PORT=5432

# Database name
DB_NAME=unicity_test

# Database user
DB_USER=test

# Database password (use secrets in CI)
DB_PASSWORD=

# =============================================================================
# Feature Flags
# =============================================================================

# Enable experimental features in tests
ENABLE_EXPERIMENTAL=0

# Enable integration tests
ENABLE_INTEGRATION_TESTS=1

# Enable E2E tests
ENABLE_E2E_TESTS=1

# Enable performance tests
ENABLE_PERF_TESTS=0

# =============================================================================
# Debugging Options
# =============================================================================

# Enable detailed debugging
DEBUG=0

# Enable BATS debugging
BATS_DEBUG=0

# Keep test artifacts after run
KEEP_ARTIFACTS=0

# Print environment variables on startup
PRINT_ENV=0

# =============================================================================
# Compatibility Configuration
# =============================================================================

# Bash version requirement (minimum)
BASH_MIN_VERSION=4

# Node.js version requirement
NODE_MIN_VERSION=20

# NPM version requirement
NPM_MIN_VERSION=10

# =============================================================================
# Conditional Configurations
# =============================================================================

# Production test configuration
if [[ "${ENVIRONMENT:-}" == "production" ]]; then
    UNICITY_TEST_SKIP_EXTERNAL=0
    SECURE_ONLY=1
    SSL_VERIFY=1
    PARALLEL_TESTS=0
fi

# Development test configuration
if [[ "${ENVIRONMENT:-}" == "development" ]]; then
    UNICITY_TEST_DEBUG=1
    UNICITY_TEST_VERBOSE=1
    PARALLEL_TESTS=1
    LOG_LEVEL=debug
fi

# Docker test configuration
if [[ "${RUNNING_IN_DOCKER:-}" == "true" ]]; then
    AGGREGATOR_HOST=aggregator
    AGGREGATOR_ENDPOINT=http://aggregator:3000
    BATS_TMPDIR=/tmp/bats-tmp
fi

# =============================================================================
# Version Information
# =============================================================================

# Configuration version
CONFIG_VERSION=1.0.0

# Last updated
CONFIG_UPDATED=2024-01-15

# Maintained by
CONFIG_MAINTAINER=Unicity Network

# =============================================================================
# Notes
# =============================================================================

# This configuration file is sourced by test scripts and CI/CD pipelines.
# Environment-specific overrides can be set via:
#   1. Environment variables
#   2. Command-line arguments
#   3. CI platform environment
#   4. Local .env files (not tracked in git)
#
# Security Note: Do not commit sensitive values like tokens or passwords.
# Use CI platform secrets management for sensitive configuration.
